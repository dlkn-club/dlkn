<!DOCTYPE html>
<html lang="{{ site.lang | default: "ru" }}">
  <head>
    {% include head.html %}
  </head>
  <body class="page-{{ page.slug }}">
    {% include header.html %}
    <div class="page-layer">
      <div class="page-body{% if page.url == '/404.html' %} page-body--no-sidebar{% endif %}">
        {% unless page.url == '/404.html' %}
          <div class="page-sidebar">
            {% include sidebar.html %}
          </div>
        {% endunless %}
        <main class="page-main page-content">
          {{ content }}
        </main>
      </div>
    </div>
    {% unless page.url == '/404.html' %}
      <footer class="footer-layer">
        {% include footer.html %}
      </footer>
    {% endunless %}
    <script src="{{ '/assets/js/footer-webgl.js' | relative_url }}"></script>
    <script>
      (function () {
        const footerLayer = document.querySelector(".footer-layer");
        if (!footerLayer) return;
        if (window.initFooterWebGL) {
          window.initFooterWebGL(footerLayer);
        }
        const root = document.documentElement;
        const updateFooterHeight = () => {
          root.style.setProperty("--footer-h", `${footerLayer.offsetHeight}px`);
        };
        updateFooterHeight();
        if (window.ResizeObserver) {
          const observer = new ResizeObserver(updateFooterHeight);
          observer.observe(footerLayer);
        } else {
          window.addEventListener("resize", updateFooterHeight);
        }
      })();
    </script>
  </body>
</html>
